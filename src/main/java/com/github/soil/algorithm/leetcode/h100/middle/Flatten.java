package com.github.soil.algorithm.leetcode.h100.middle;

import com.github.soil.algorithm.leetcode.editor.cn.TreeNode;

/**
 * <a href="https://leetcode.cn/problems/flatten-binary-tree-to-linked-list/?envType=study-plan-v2&envId=top-100-liked">
 *     äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨</a>
 *     ä¸¤ç§æ–¹æ³•ï¼šåå‘ååºéå† or è¿­ä»£æ³•
 *    åå‘ååºéå† æ—¶ç©ºé—´å¤æ‚åº¦éƒ½ä¸ºO(N)ã€‚è¿­ä»£æ—¶é—´å¤æ‚åº¦ä¸ºO(N)ï¼Œä½†ç©ºé—´å¤æ‚åº¦ä¸ºOï¼ˆ1ï¼‰ï¼Œæ›´æ¨è
 *
 *    åå‘ååºéå†æ ¸å¿ƒï¼šæ­£å¸¸äºŒå‰æ ‘éƒ½æ˜¯å…ˆå¤„ç†å·¦å­æ ‘ï¼Œå†å¤„ç†å³å­æ ‘ã€‚
 *    ä½†æˆ‘ä»¬è¿™é‡Œåè¿‡æ¥å³å˜æˆäº†å…ˆåºéå†çš„ç»“æœåå‘æ‰“å°ï¼Œè¿™é‡Œå…ˆéå†å‡ºçš„ç»“æœå°±æ˜¯é“¾è¡¨çš„æœ«å°¾ï¼Œå¯ä»¥ç›´æ¥è°ƒæ•´æŒ‡é’ˆï¼Œä¸å½±å“åç»­éœ€è¦å¤„ç†çš„èŠ‚ç‚¹ã€‚
 *
 *    è¿­ä»£æ³•å’ŒMorriséå†å¾ˆç±»ä¼¼ï¼Œä½†å› ä¸ºæ˜¯è¦æ±‚å…ˆåºï¼Œ
 *      æ‰€ä»¥å½“å‰èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹åœ¨å…ˆåºéå†ä¸­çš„preå³æ˜¯å½“å‰èŠ‚ç‚¹å·¦å­æ ‘ä¸­æœ€å³çš„èŠ‚ç‚¹ï¼ˆå³å·¦å­æ ‘æœ€å³èŠ‚ç‚¹çš„nextæ˜¯å½“å‰èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹ï¼‰ï¼Œ
 *     è€Œå½“å‰èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹åœ¨å…ˆåºéå†ä¸­çš„preå³ä½¿å½“å‰èŠ‚ç‚¹ï¼ˆå³å½“å‰èŠ‚ç‚¹çš„nextæ˜¯å·¦å­èŠ‚ç‚¹ï¼‰
 *     æ‰€ä»¥æ ¹æ®è¿™ä¸¤ä¸ªç‰¹æ€§ä¸æ–­çš„ç§»åŠ¨èŠ‚ç‚¹ä½ç½®ï¼Œç›´åˆ°å½“å‰èŠ‚ç‚¹ä¸ºç©ºå³å¤„ç†å®Œæ¯•
 *
 *     æ–¹æ³•æ€»ç»“ï¼š
 *  ğŸ”¹ åå‘ååºéå† (Right -> Left -> Root)
 *     - ä¼ ç»Ÿéå†é¡ºåºæ˜¯å·¦ -> å³ -> æ ¹ï¼Œæˆ‘ä»¬åè¿‡æ¥å˜æˆå³ -> å·¦ -> æ ¹ã€‚
 *     - è¿™æ ·å…ˆéå†åˆ°çš„èŠ‚ç‚¹æ˜¯æœ€ç»ˆé“¾è¡¨çš„æœ«å°¾ï¼Œå¯ä»¥ç›´æ¥è°ƒæ•´æŒ‡é’ˆï¼Œä¸å½±å“åç»­èŠ‚ç‚¹ã€‚
 *     - **æ—¶é—´å¤æ‚åº¦ O(N)ï¼Œç©ºé—´å¤æ‚åº¦ O(N)ï¼ˆé€’å½’æ ˆç©ºé—´ï¼‰**ã€‚
 *  ğŸ”¹ è¿­ä»£æ³•ï¼ˆåŸºäº Morris éå†ï¼‰
 *     - ç”±äºå±•å¼€åçš„é“¾è¡¨é¡ºåºæ˜¯ **å…ˆåºéå† (Root -> Left -> Right)**ï¼Œå…³é”®æ˜¯æ­£ç¡®è°ƒæ•´å·¦å³å­æ ‘ï¼š
 *       1. **å·¦å­æ ‘æœ€å³èŠ‚ç‚¹çš„ right æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„ right**ï¼ˆç¡®ä¿å³å­æ ‘æ‹¼æ¥åˆ°å·¦å­æ ‘çš„æœ€å³ç«¯ï¼‰ã€‚
 *       2. **å½“å‰èŠ‚ç‚¹çš„ right æŒ‡å‘å·¦å­æ ‘**ï¼Œç„¶åç½® `left = null`ã€‚
 *       3. **å‘å³ç§»åŠ¨**ï¼Œç»§ç»­å±•å¼€ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚
 */
public class Flatten {

    // ========================== æ–¹æ³•1:åå‘ååºéå† ==========================
    // å½“å‰å·²å±•å¼€é“¾è¡¨çš„å¤´èŠ‚ç‚¹
    private TreeNode next;

    public void flatten(TreeNode root) {
        if (root == null){
            return;
        }
        // é€’å½’å¤„ç†å³å­æ ‘ï¼ˆå…ˆå±•å¼€å³å­æ ‘ï¼‰
        flatten(root.right);
        // é€’å½’å¤„ç†å·¦å­æ ‘ï¼ˆå†å±•å¼€å·¦å­æ ‘ï¼‰
        flatten(root.left);

        // è®©å½“å‰èŠ‚ç‚¹çš„å³å­æ ‘æŒ‡å‘ nextï¼Œå¹¶æ¸…ç©ºå·¦å­æ ‘
        root.right = next;
        root.left = null;
        // æ›´æ–° next ä¸ºå½“å‰èŠ‚ç‚¹
        next = root;
    }

    // ========================== æ–¹æ³•2:è¿­ä»£ï¼ˆMorris éå†ï¼‰ ==========================
    public void flattenByRecursion(TreeNode root) {
        if (root == null){
            return;
        }
        TreeNode cur= root;
        while (cur != null){
            // è‹¥å­˜åœ¨å·¦å­æ ‘
            if (cur.left != null) {
                TreeNode mostRight = cur.left;
                // æ‰¾åˆ°å·¦å­æ ‘çš„æœ€å³èŠ‚ç‚¹
                while (mostRight.right != null) {
                    mostRight = mostRight.right;
                }
                // å°†å³å­æ ‘æ¥åˆ°æœ€å³èŠ‚ç‚¹çš„å³å­æ ‘ä¸Š
                mostRight.right = cur.right;
                // å·¦å­æ ‘å˜ä¸ºå³å­æ ‘ï¼Œå¹¶æ¸…ç©ºå·¦å­æ ‘
                cur.right = cur.left;
                cur.left = null;
            }
            // ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
            cur = cur.right;

        }
    }

}

